<div fxLayout="column" fxLayoutGap="40px">

    <ngx-generic-header title="Access Mapping"></ngx-generic-header>

    <div>

        <mat-tab-group mat-stretch-tabs (selectedTabChange)="onTabChange($event)">
            <mat-tab>
                <ng-template mat-tab-label>
                    <mat-icon class="icon">home</mat-icon>
                    Role-Menu Mapping
                </ng-template>
                <mat-divider class="divider-one"></mat-divider>

                <form (submit)="saveRTM(menuItemList)">
                    <mat-card class="card-tab">
                        <mat-form-field class="filtered-autocomplete roleDdFormField" appearance="outline" floatLabel="always">
                            <mat-label>Role</mat-label>
                            <input type="text" placeholder="Choose Role" matInput [formControl]="roleControl"
                                [matAutocomplete]="autoCompleteRole">
                            <mat-icon matSuffix class="arrow-down">arrow_drop_down</mat-icon>
                            <mat-autocomplete #autoCompleteRole="matAutocomplete" [displayWith]="displayRole"
                                (optionSelected)='changeRole($event.option.value.key)'>
                                <mat-option *ngFor="let option of roleDDList" [value]="option">
                                    {{option.value}}
                                </mat-option>
                            </mat-autocomplete>
                        </mat-form-field>
                        <section class="example-section" *ngFor="let menuItem of menuItemList">
                            <span class="example-list-section">
                                <mat-checkbox class="example-margin" [(ngModel)]="menuItem.isActive" #values
                                    (change)="allChildCheckUpdate(menuItem.itemId,values.checked)"
                                    [ngModelOptions]="{standalone: true}">
                                    {{menuItem.itemName}}
                                </mat-checkbox>
                            </span>
                            <span class="example-list-section">
                                <ul>
                                    <li *ngFor="let menuChild of menuItem.children" class="listOfChildMenu">
                                        <mat-checkbox [(ngModel)]="menuChild.isActive" #value
                                            [ngModelOptions]="{standalone: true}"
                                            (change)="ParentCheckUpdateForAllChild(menuItem.itemId)">
                                            {{menuChild.itemName}}
                                        </mat-checkbox>
                                    </li>
                                </ul>
                            </span>
                        </section>


                        <button mat-button type="submit" class="btn-save" *ngIf="menuItemList.length>0">
                            <mat-icon class="btn-icon">
                                save
                            </mat-icon> Save
                        </button>
                    </mat-card>
                </form>
            </mat-tab>

            <mat-tab>
                <ng-template mat-tab-label>
                    <mat-icon class="icon">mail</mat-icon>
                    User-Menu Mapping
                </ng-template>
                <mat-divider class="divider-one"></mat-divider>
                <form (submit)="saveUTM(menuItemList)">
                    <mat-card class="card-tab">
                        <mat-form-field class="userDdFormField" appearance="outline" floatLabel="always">
                            <mat-label>User</mat-label>
                            <input type="text" placeholder="Choose User" matInput [formControl]="userControl"
                                [matAutocomplete]="autoCompleteUser">
                            <mat-icon matSuffix class="arrow-down">arrow_drop_down</mat-icon>
                            <mat-autocomplete #autoCompleteUser="matAutocomplete" [displayWith]="displayUser"
                                (optionSelected)='changeUser($event.option.value.key)'>
                                <mat-option *ngFor="let option of userDDList" [value]="option">
                                    {{option.value}}
                                </mat-option>
                            </mat-autocomplete>
                        </mat-form-field>

                        <section class="example-section" *ngFor="let menuItem of menuItemList">
                            <span class="example-list-section">
                                <mat-checkbox class="example-margin" [(ngModel)]="menuItem.isActive" #values
                                    (change)="allChildCheckUpdate(menuItem.itemId,values.checked)"
                                    [ngModelOptions]="{standalone: true}">
                                    {{menuItem.itemName}}
                                </mat-checkbox>
                            </span>
                            <span class="example-list-section">
                                <ul>
                                    <li *ngFor="let menuChild of menuItem.children" class="listOfChildMenu">
                                        <mat-checkbox [(ngModel)]="menuChild.isActive" #value
                                            [ngModelOptions]="{standalone: true}"
                                            (change)="ParentCheckUpdateForAllChild(menuItem.itemId)">
                                            {{menuChild.itemName}}
                                        </mat-checkbox>
                                    </li>
                                </ul>
                            </span>
                        </section>

                        <button mat-button type="submit" class="btn-save" *ngIf="menuItemList.length>0">
                            <mat-icon class="btn-icon">
                                save
                            </mat-icon><span>Save</span>
                        </button>
                    </mat-card>
                </form>
            </mat-tab>

            <mat-tab>
                <ng-template mat-tab-label>
                    <mat-icon class="icon">mail</mat-icon>
                    User-Menu Restriction
                </ng-template>
                <mat-divider class="divider-one"></mat-divider>
                <form (submit)="saveUTMRestriction(menuItemList)">
                    <mat-card class="card-tab">
                        <mat-form-field class="userRestrictionDdFormField" appearance="outline" floatLabel="always">
                            <mat-label>User</mat-label>
                            <input type="text" placeholder="Choose User" matInput [formControl]="userRestrictionControl"
                                [matAutocomplete]="autoCompleteUserRestriction">
                            <mat-icon matSuffix class="arrow-down">arrow_drop_down</mat-icon>
                            <mat-autocomplete #autoCompleteUserRestriction="matAutocomplete" [displayWith]="displayUserRestriction"
                                (optionSelected)='changeUserForRestrictedMenu($event.option.value.key)'>
                                <mat-option *ngFor="let option of userDDListForRestrictedMenu" [value]="option">
                                    {{option.value}}
                                </mat-option>
                            </mat-autocomplete>
                        </mat-form-field>

                        <section class="example-section" *ngFor="let menuItem of menuItemList">
                            <span class="example-list-section">
                                <mat-checkbox class="example-margin" [(ngModel)]="menuItem.isActive" #values
                                    (change)="allChildCheckUpdate(menuItem.itemId,values.checked)"
                                    [ngModelOptions]="{standalone: true}">
                                    {{menuItem.itemName}}
                                </mat-checkbox>
                            </span>
                            <span class="example-list-section">
                                <ul>
                                    <li *ngFor="let menuChild of menuItem.children" class="listOfChildMenu">
                                        <mat-checkbox [(ngModel)]="menuChild.isActive" #value [ngModelOptions]="{standalone: true}"
                                            (change)="ParentCheckUpdateForAllChild(menuItem.itemId)">
                                            {{menuChild.itemName}}
                                        </mat-checkbox>
                                    </li>
                                </ul>
                            </span>
                        </section>
            
            
                        <button mat-button type="submit" class="btn-save" *ngIf="menuItemList.length>0">
                            <mat-icon class="btn-icon">
                                save
                            </mat-icon> Save
                        </button>
                    </mat-card>
                </form>
            
            </mat-tab>
        </mat-tab-group>
    </div>

</div>