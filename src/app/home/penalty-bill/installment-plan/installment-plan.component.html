<nb-card>
    <nb-card-header class="header-section">Penalty Bill Installment Plan</nb-card-header>

    <nb-card-body class="container">
        <form [formGroup]="installmentform">
        <h2 class="form-header-section">Bill Information</h2>

        <hr class="hr-vertical">

        <div class="row">
            <div class="col-sm-6">
                <div class="form-group row">
                    <label for="customerType" class="label col-sm-4 col-form-label">Customer Number:</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control no-border" formControlName="customerNumber" fullWidth placeholder="Customer Number">
                    </div>
                </div>
            </div>

            <div class="col-sm-6">
                <div class="form-group row">
                    <label for="customerType" class="label col-sm-4 col-form-label">Location :</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control no-border" formControlName="location" readonly placeholder="Location">
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6">
                <div class="form-group row">
                    <label for="customerType" class="label col-sm-4 col-form-label">Name :</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control no-border" formControlName="customerName"  readonly placeholder=" Customer Name">
                    </div>
                </div>
            </div>

            <div class="col-sm-6">
                <div class="form-group row">
                    <label for="customerType" class="label col-sm-4 col-form-label">Address :</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control no-border" formControlName="address" readonly placeholder="Address">
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-6">
                <div class="form-group row">
                    <label for="customerType" class="label col-sm-4 col-form-label">Tariff :</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control no-border" formControlName="tariff" readonly placeholder=" Tariff :">
                    </div>
                </div>
            </div>

            <div class="col-sm-6">
                <div class="form-group row">
                    <label for="customerType" class="label col-sm-4 col-form-label">Bill Number :</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control no-border" formControlName="billNumber" readonly placeholder="Bill Number ">
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-sm-6">
                <div class="form-group row">
                    <label for="customerType" class="label col-sm-4 col-form-label">Total Amount :</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control no-border" formControlName="billAmount" readonly placeholder=" Bill Amount">
                    </div>
                </div>
            </div>

            <div class="col-sm-6">
                
            </div>
        </div>
        <div class="row">
            <div class="col-sm-6">
                <div class="form-group row">
                    <label for="customerType" class="label col-sm-4 col-form-label">1st Installment%<span
                            class="text-danger">*</span>:</label>
                    <div class="col-sm-7">
                        <input type="number" class="form-control " formControlName="installmentPercn"  fullWidth placeholder="1st Installment" />
                    </div>
                    <label for="customerType" class="label col-sm-1" id="test">%</label>
                    
                </div>
            </div>

            <div class="col-sm-6">
                <div class="form-group row">
                    <label for="customerType" class="label col-sm-4 col-form-label">Rest Installment No<span
                            class="text-danger">*</span>:</label>
                    <div class="col-sm-8">
                        <input type="number" class="form-control" formControlName="installNumber" fullWidth placeholder="Rest Installment No" (ngModelChange)="getVatLps()">
                    </div>
                </div>
            </div>
        </div>
        <br>

        <div class="row mb-2">
            <div class="col-sm-2 offset-sm-2">
                <button nbButton fullWidth status="success" (click)="calculateInstallment()" > Calculate </button>
            </div>

        </div>
        <h2 class="form-header-section">Installment Details</h2>
        <hr class="hr-vertical">
        <table class="table">
            <thead>
              <tr>
                    <th>Sn</th>
                    <th>Principle</th>
                    <th>Vat</th>
                    <th>Lps</th>
                    <th>Amount to be paid</th>
                    <th>Due Date</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody >
              <tr *ngFor="let installment of installmentFormArray.controls; let i=index" [formGroup]="installment" >
                    <th scope="row">{{i+1}}</th>
                    <td>
                        <input type="number" class="form-control no-border" formControlName="principleAmount" readonly >
                    </td>
                    <td >
                        <input type="number" class="form-control no-border" formControlName="vatAmount" readonly >
                    </td>
                    <td >
                        <input type="number" class="form-control no-border" formControlName="lpsAmount" readonly >
                    </td>
                    <td >
                        <input type="number" class="form-control no-border"  formControlName="totalAmount" readonly >
                    </td>
                    <td >
                        <input nbInput placeholder="Due Date" formControlName="selectDate" (ngModelChange)="modelChangeFn($event,i)" fullWidth [nbDatepicker]="formpicker">
                        <nb-datepicker #formpicker [min]="disableDate" ></nb-datepicker>
                    </td>
                    <td></td>
              </tr>
            </tbody>
               
          </table>
          <div class="row ">
            <div class="col-md-4">
               
            </div>
            <div class="col-md-5">
                <div class="row">
                    <div class="col-md-8">
                        <label for="totalQuantity" style="text-align: right !important; font-weight: bold; font-size: 16px;" class=" col-form-label text-right">Total amount to be paid :</label>
                    </div>
                    <div class="col-md-4">
                        <label for="totalQuantity" style="text-align: left !important; font-weight: bold; font-size: 16px;"  class=" col-form-label align-left">{{totalAmount | number: "1.2-2"}}</label>
                    </div>
                </div>

                
            </div>

            
        </div>
         
        </form>
        <div class="row mb-2">
            <div class="col-sm-2 offset-sm-2">
                <button nbButton fullWidth status="primary" (click)="saveInstallment()"> Save </button>
            </div>

        </div>
    </nb-card-body>
</nb-card>